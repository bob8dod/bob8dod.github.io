I"¦Í<h2 id="ìˆœìˆ˜-jpaì™€-querydsl">ìˆœìˆ˜ JPAì™€ Querydsl</h2>

<p>ìˆœìˆ˜ JPAì™€ Querydslì˜ ì°¨ì´ì ì„ í™•ì¸í•˜ë©° <strong>Repository ìƒì„±</strong>í•´ë³´ê¸°</p>

<h3 id="querydslì„-ì´ìš©í•œ-ë¦¬í¬ì§€í† ë¦¬">Querydslì„ ì´ìš©í•œ ë¦¬í¬ì§€í† ë¦¬</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">MemberQueryRepository</code> ìƒì„±</li>
  <li>
    <p>Classë‹¨ Annotation</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Repository</span>
  <span class="nd">@RequiredArgsConstructor</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberQueryRepository</span> <span class="o">{...}</span>
</code></pre></div>    </div>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">@Repository</code> : ì»´í¬ë„ŒíŠ¸ë¡œ ë“±ë¡, í•˜ìœ„ JPAì˜ ì˜¤ë¥˜ë¥¼ <strong>ìƒìœ„ Springì˜ ì˜¤ë¥˜ë¡œ ë³€ê²½</strong>í•´ì¤Œ</li>
      <li><code class="language-plaintext highlighter-rouge">@RequiredArgsConstructor</code> : private final ë¡œ ì„¤ì •ëœ fieldì— ëŒ€í•´ <strong>ìë™ìœ¼ë¡œ DIì‹¤í–‰</strong> â†’ ìƒì„±ìë¥¼ í†µí•´</li>
    </ul>
  </li>
  <li>
    <p>ì˜ì¡´ì„± ì£¼ì… (DI)</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>
</code></pre></div>    </div>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">EntityManager em;</code>
        <ul>
          <li><strong>EntityManger</strong> ì£¼ì…</li>
          <li>Springì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒì´ ì•„ë‹Œ <strong>JPAì—ì„œ ì£¼ì…</strong>í•´ì£¼ëŠ” ê²ƒ</li>
          <li><code class="language-plaintext highlighter-rouge">@PersistanceContext</code>ë¡œ <strong>ì£¼ì…</strong> ê°€ëŠ¥</li>
        </ul>
      </li>
      <li><code class="language-plaintext highlighter-rouge">JPAQueryFactory queryFactory;</code>
        <ul>
          <li><strong>JPAQueryFactory</strong> ì£¼ì…</li>
          <li><strong>[ì¤‘ìš”]</strong> <strong>í•­ìƒ ì´ìš©ë˜ëŠ” EntityMangerë¥¼ ë„£ì–´ì£¼ì–´ì•¼ í•¨</strong></li>
          <li>
            <p><strong>JPAQueryFactory</strong>ë¥¼ <strong>Beanìœ¼ë¡œ ë“±ë¡</strong>í•˜ì—¬ <strong>Springì—ì„œ ì£¼ì…</strong>í•  ìˆ˜ ìˆê²Œ ì„¤ì • ê°€ëŠ¥</p>

            <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@PersistenceContext</span>
  <span class="kd">private</span> <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>
            
  <span class="nd">@Bean</span> <span class="c1">// ë¹ˆìœ¼ë¡œ ë“±ë¡ -&gt; ì˜ì¡´ì„± ì£¼ì… ê°€ëŠ¥</span>
  <span class="nc">JPAQueryFactory</span> <span class="nf">jpaQueryFactory</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">JPAQueryFactory</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>            </div>
          </li>
          <li>
            <p>í˜¹ì€ ê°ê°ì˜ ë‹¨ì—ì„œ <strong>ìƒì„±ìë¥¼ í†µí•´ emì„ ë„£ì–´ì¤Œ</strong>ê³¼ í•¨ê»˜ ìƒì„±í•  ìˆ˜ ìˆìŒ</p>

            <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@PersistenceContext</span>
  <span class="kd">private</span> <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>
            
  <span class="kd">public</span> <span class="nf">MemberJPARepository</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">queryFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQueryFactory</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
    </ul>

    <aside>
  ğŸ’¡ <strong>EntityMangerì™€ JPAQueryFactoryì˜ ë™ì‹œì„± ë¬¸ì œ</strong>
  <ul>
  <li> <b>EntityManger</b>ëŠ” <b>ì‹±ê¸€í†¤</b>ìœ¼ë¡œ ìš´ì˜ë˜ê¸° ë•Œë¬¸ì— í•­ìƒ ê°™ì€ <b>EntityManger</b>ë¥¼ ë°›ê²Œë¨ </li>
  <li> ê° ë©”ì„œë“œì— ëŒ€í•œ <b>EntityManger</b>ì€ <b>Transcation ë‹¨ìœ„ë¡œ ë™ì‘</b>í•˜ëŠ” ê²ƒ â†’ <b>ë™ì‹œì„± ë¬¸ì œë°œìƒ X</b> </li>
  <li> <b>JPAQueryFactory</b> ë˜í•œ <b>ì‹±ê¸€í†¤</b>ìœ¼ë¡œ ìš´ì˜ </li>
  <li> <b>JPAQueryFactory</b>ëŠ” <b>EntityManger</b>ì„ ë°›ì•„ì„œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— <b>ë˜‘ê°™ì´ ë™ì‹œì„± ë¬¸ì œ X</b> </li>
  </ul>
  </aside>

    <ul>
      <li>
        <p><strong>ì €ì¥</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li>Querydslë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒë³´ë‹¤ <strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê¹Œì§€ ê³ ë ¤í•˜ì—¬ JPAì˜ ê¸°ë³¸ ì €ì¥</strong> ë¡œì§ì¸ <code class="language-plaintext highlighter-rouge">em.persist()</code>ë¥¼ ì‚¬ìš©</li>
        </ul>
      </li>
      <li>
        <p>ì‹ë³„ì <strong>ì¡°íšŒ</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
      <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li>Querydslë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒë³´ë‹¤ <strong>JPAì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µ</strong>í•˜ëŠ” <code class="language-plaintext highlighter-rouge">em.find()</code> ì´ìš© â†’ ë” í¸ë¦¬</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>ì „ì²´ ì¡°íšŒ</strong>
    <ul>
      <li>
        <p><strong>ìˆœìˆ˜ JPA</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select m from Member m"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
              <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><strong>ì§ì ‘ ë¬¸ìì—´ë¡œ JPQLì„ ì‘ì„±</strong>í•´ì£¼ì–´ì•¼ í•¨ â†’ ê°œë°œ í¸ì˜ì„± DOWN</li>
          <li><strong>Class</strong> ë¥¼ <strong>ì§ì ‘ ì§€ì •</strong>í•´ì£¼ì–´ì•¼ í•¨</li>
          <li>ë¬¸ìì—´ì˜ JPQLì€ <strong>ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ ê²€ì¶œì´ ë¶ˆê°€ëŠ¥</strong> â†’ ì‚¬ìš©ìê°€ ì§ì ‘ í•´ë‹¹ methodì— ì ‘ê·¼ ì‹œ ì˜¤ë¥˜ í™•ì¸ ê°€ëŠ¥ â†’ êµ‰ì¥íˆ ë¶ˆì™„ì „í•œ ê°œë°œ</li>
        </ul>
      </li>
      <li>
        <p><strong>Querydsl ì´ìš©</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findAll_Querydsl</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">queryFactory</span>
              <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span> <span class="c1">// QMember.member</span>
              <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">member</code> â†’ <code class="language-plaintext highlighter-rouge">QMember.member</code> ë¥¼ <strong>static import</strong></li>
          <li><strong>ìë°” ì½”ë“œ</strong>ë¡œì¨ SQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ â†’ ê°œë°œ í¸ì˜ì„± UP</li>
          <li>Class ì§ì ‘ ì§€ì •í•  í•„ìš” ì—†ì´, <strong>Entityì˜ Q-Typeìœ¼ë¡œ ë™ì‘</strong></li>
          <li><strong>Application ë¡œë”© ì‹œì ì— ì˜¤ë¥˜ í™•ì¸ ê°€ëŠ¥!</strong> (<strong>ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ ê²€ì¶œ</strong>)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>ì´ë¦„ì— ë”°ë¥¸ ì¡°íšŒ</strong>
    <ul>
      <li>
        <p><strong>ìˆœìˆ˜ JPA</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select m from Member m where m.username = :username"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
              <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">,</span> <span class="n">username</span><span class="o">)</span>
              <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><strong>where ì¡°ê±´</strong> ë§ˆì € <strong>ë¬¸ìì—´ë¡œ</strong> ì‘ì„±</li>
          <li>íŒŒë¼ë¯¸í„° <strong>ë°”ì¸ë”©ì„ ì§ì ‘</strong> ì§„í–‰</li>
        </ul>
      </li>
      <li>
        <p><strong>Querydsl</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByUsername_Querydsl</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">queryFactory</span>
              <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
              <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">username</span><span class="o">))</span>
              <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><strong>where ì¡°ê±´</strong>ì„ <strong>ìë°” ì½”ë“œ</strong>ë¡œ ì‘ì„± â†’ <strong>ë™ì  ì¿¼ë¦¬ ê°€ëŠ¥</strong></li>
          <li><code class="language-plaintext highlighter-rouge">.eq(username)</code>ì„ í†µí•´ <strong>íŒŒë¼ë¯¸í„° ë°”ì¸ë”©</strong>ì„ <strong>Querydslì—ì„œ ìë™</strong>ìœ¼ë¡œ ì§„í–‰</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="ë™ì -ì¿¼ë¦¬-ì„±ëŠ¥-ìµœì í™”-ì¡°íšŒdto-ì¡°íšŒ">ë™ì  ì¿¼ë¦¬, ì„±ëŠ¥ ìµœì í™” ì¡°íšŒ(DTO ì¡°íšŒ)</h3>

<ul>
  <li><strong>DTO ìƒì„±</strong>
    <ul>
      <li><strong>ìˆœìˆ˜ JPA</strong>ë¥¼ í†µí•´ DTOë¡œ ì§ì ‘ ì¡°íšŒí•œë‹¤ë©´?
        <ul>
          <li><strong>íŒ¨í‚¤ì§€ëª…ì„ ëª¨ë‘</strong> ì ì–´ì¤˜ì•¼ í•¨</li>
          <li><strong>ë¬¸ìì—´</strong>ë¡œ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— <strong>IDEì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†</strong>ìœ¼ë©° <strong>ì»´íŒŒì¼ ì‹œì ì— ì˜¤ë¥˜ í™•ì¸ ë¶ˆê°€</strong></li>
          <li><strong>Querydsl</strong>ì˜ <code class="language-plaintext highlighter-rouge">Projection</code>, <code class="language-plaintext highlighter-rouge">@QueryProjection</code> ë¥¼ í†µí•´ í•´ê²° ê°€ëŠ¥</li>
        </ul>
      </li>
      <li>
        <p>Member ì •ë³´ì™€ Team ì •ë³´ë¥¼ í•¨ê»˜ ë°›ì€ <strong>DTO ìƒì„± by Querydsl</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Data</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberTeamDto</span> <span class="o">{</span>
      <span class="c1">// Memberì™€Team ì •ë³´ë¥¼ ê°™ì´ ë°˜í™˜í•´ì¤„ DTO</span>
      <span class="kd">private</span> <span class="nc">Long</span> <span class="n">memberId</span><span class="o">;</span>
      <span class="o">...</span>
      <span class="kd">private</span> <span class="nc">Long</span> <span class="n">teamId</span><span class="o">;</span>
  		<span class="o">..</span>
        
      <span class="nd">@QueryProjection</span> <span class="c1">// í•´ë‹¹ DTO ìƒì„±ìì— ëŒ€í•œ QType ìƒì„±</span>
      <span class="kd">public</span> <span class="nf">MemberTeamDto</span><span class="o">(</span><span class="nc">Long</span> <span class="n">memberId</span><span class="o">,</span> <span class="o">...)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">memberId</span> <span class="o">=</span> <span class="n">memberId</span><span class="o">;</span>
          <span class="o">...</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">@QueryProjection</code> ì‚¬ìš©
            <ul>
              <li>í•´ë‹¹ <strong>DTO ìƒì„±ìì— ëŒ€í•œ QType ìƒì„±</strong></li>
              <li>í•­ìƒ ì–´ë…¸í…Œì´ì…˜ì„ ë‹¬ì•„ì£¼ê³  <code class="language-plaintext highlighter-rouge">compileQuerydsl</code> ì„ í†µí•´ <strong>ì‹¤ì œ QTypeì„ ìƒì„±</strong>í•´ ì£¼ì–´ì•¼ í•¨ (ì‹¤í–‰ í›„ ì €ì¥ ê²½ë¡œ(<code class="language-plaintext highlighter-rouge">build/generated/â€¦</code>)ì—ì„œ í™•ì¸)</li>
              <li>ë” í¸ë¦¬í•˜ê²Œ <strong>new ì˜¤í¼ë ˆì´ì…˜ìœ¼ë¡œ DTO ì§ì ‘ ì¡°íšŒ</strong>ê°€ ê°€ëŠ¥</li>
              <li>DTOê°€ <strong>Querydslì„ ì˜ì¡´í•˜ê²Œ ëœë‹¤ëŠ” ë‹¨ì </strong> ì¡´ì¬ â†’ <strong>í•´ë‹¹ DTOë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë‹¨ì—ì„œ ë˜í•œ Querydslì„ ì˜ì¡´í•˜ê²Œ ë¨</strong></li>
              <li>ëŒ€ì‹  <strong>Projection</strong>ì˜ <code class="language-plaintext highlighter-rouge">.bean()</code>, <code class="language-plaintext highlighter-rouge">.fields()</code>, <code class="language-plaintext highlighter-rouge">.constructor()</code> ì„ ì‚¬ìš©í•´ë„ ë¨ â†’ <strong>ì˜ì¡´ì„± X</strong></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>ë™ì  ì¿¼ë¦¬</strong> ì‘ì„±
    <ul>
      <li><strong>ìˆœìˆ˜ JPA</strong>ë¡œ ë™ì ì¿¼ë¦¬ ì‘ì„±í•œë‹¤ë©´?
        <ul>
          <li><strong>ë¬¸ìì—´ ì¡°í•©</strong>ìœ¼ë¡œ ì§„í–‰í•´ì•¼ ë¨</li>
          <li><strong>ì¬ì‚¬ìš©ì´ ë¶ˆê°€</strong>ëŠ¥í•˜ë©° <strong>ì˜¤ë¥˜ ê²€ì¶œì„ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ë¶ˆê°€</strong>ëŠ¥í•˜ì—¬ ê°œë°œ ìƒì‚°ì„±ì´ ë‚®ì•„ì§</li>
          <li><strong>Querydsl</strong>ì˜ <code class="language-plaintext highlighter-rouge">BooleanBuilder</code>, <code class="language-plaintext highlighter-rouge">BooleanExpression</code> ì‚¬ìš©í•˜ì—¬ í•´ê²° ê°€ëŠ¥</li>
        </ul>
      </li>
      <li>
        <p><strong>BooleanBuilder</strong>ë¥¼ í†µí•œ <strong>ë™ì  ì¿¼ë¦¬ by Querydsl</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchByBuilder</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">cond</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">BooleanBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">hasText</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()))</span> <span class="o">{</span> <span class="c1">// ê²€ìƒ‰ëœ Memberì˜ ì´ë¦„ì´ null í˜¹ì€ ""ì´ ì•„ë‹ˆë©´</span>
          <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()));</span> <span class="c1">// í•´ë‹¹ ì¡°ê±´ builderì— ì¶”ê°€</span>
      <span class="o">}</span>
      <span class="o">...</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">goe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()));</span>
      <span class="o">}</span>
      <span class="o">...</span>
        
      <span class="k">return</span> <span class="n">queryFactory</span>
              <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                      <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
              <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span> <span class="c1">// inner joinì´ ì•„ë‹ˆë¼ outer join -&gt; where ë¬¸ì—ì„œ joinëœ teamì— ëŒ€í•´ì„œ íŒë‹¨í•˜ë¯€ë¡œ teamì€ nullì´ë©´ ì•ˆë¨ (teamì´ nullì¸ memberëŠ” ì œì™¸)</span>
              <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span> <span class="c1">// fetchJoin() X -&gt; ì—°ê´€ëœ Entityë¥¼ ë„£ëŠ” ê²ƒì´ ì•„ë‹ˆê¸°ë•Œë¬¸</span>
              <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">builder</span><span class="o">)</span> <span class="c1">// joiní•œ í›„ whereì„ ë„£ëŠ” ì´ìœ  : joiní•œ ê²°ê³¼ì—ì„œ íŒë‹¨í•˜ë¯€ë¡œ</span>
              <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">BooleanBuilder builder = new BooleanBuilder();</code>
            <ul>
              <li>builder ìƒì„±</li>
              <li><code class="language-plaintext highlighter-rouge">.and()</code>, <code class="language-plaintext highlighter-rouge">.or()</code> ë¡œ <strong>ì²´ì¸ì‹ìœ¼ë¡œ ì—°ê²°</strong>ì§€ì–´ <strong>ì¡°ê±´ì„ ì¶”ê°€</strong>í•  ìˆ˜ ìˆìŒ</li>
              <li>í˜¹ì€ <strong>ìƒì„±ìì— ê¸°ë³¸ ì¡°ê±´</strong>ì„ ë„£ì„ ìˆ˜ ìˆìŒ â†’ <code class="language-plaintext highlighter-rouge">new BooleanBuilder(member.username.eq(cond.getUsername));</code></li>
            </ul>
          </li>
          <li><strong>ì¡°ê±´ ì¶”ê°€</strong>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">if (hasText(cond.getUsername()))</code> : MemberSearchCondì˜ username ì´ null í˜¹ì€ â€œâ€(ë¹ˆ ë¬¸ìì—´)ì´ ì•„ë‹ˆë¼ë©´
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">builder.and(member.username.eq(cond.getUsername()));</code> : ë¹Œë”ì— <strong>ì¡°ê±´ ì¶”ê°€</strong> â†’ <code class="language-plaintext highlighter-rouge">where m.uesrname = :username</code></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><strong>buider</strong>ë¥¼ <strong>whereë¬¸ì— ì¶”ê°€</strong>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">.where(builder)</code></li>
              <li>ì¡°ê±´ì— ë”°ë¼ <strong>ì™„ì„±ëœ builderë¥¼ where ë¬¸ì— ë„£ìœ¼ë©´ ì¡°ê±´ì— ë”°ë¥¸ ì¡°íšŒê°€ ê°€ëŠ¥</strong>í•´ì§</li>
              <li>builderë¥¼ í†µí•´ <strong>ë™ì  ì¿¼ë¦¬</strong>ë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„</li>
              <li>MemberSearchCond ì— ì•„ë¬´ ì¡°ê±´ë„ ê±¸ë¦¬ì§€ ì•ŠëŠ”ë‹¤ë©´ <strong>builderì— ì¡°ê±´ì´ ì¶”ê°€ë˜ì§€ ì•Šì€ ìƒíƒœ</strong>ë¡œ whereë¬¸ì— ë“¤ì–´ê° â†’ <strong>ì „ì²´ ì¡°íšŒì™€ ë™ì¼</strong>í•´ì§. (í•´ë‹¹ ë¶€ë¶„ë„ ë”°ë¡œ ì²˜ë¦¬ê°€ í•„ìš”)</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>
        <p><strong>Whereì ˆ íŒŒë¼ë¯¸í„° ì‚¬ìš©</strong> (<code class="language-plaintext highlighter-rouge">BooleanExpression</code> or <code class="language-plaintext highlighter-rouge">Predicate</code> ì‚¬ìš©)</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">cond</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">queryFactory</span>
              <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                      <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
              <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
              <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
              <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span> <span class="c1">// í•´ë‹¹ ë©”ì„œë“œì—ì„œ nullì„ ë°˜í™˜í•˜ê²Œ ë˜ë©´ ë¬´ì‹œë¨</span>
                      <span class="n">teamNameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                      <span class="n">ageGoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                      <span class="n">ageLoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
              <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li>where ì¡°ê±´ë“¤ì„ <strong>methodë¡œ</strong> ë¹¼ë‚´ì„œ <strong>í•´ë‹¹ ì¡°ê±´ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´ ê·¸ ì¡°ê±´ì„ ë°˜í™˜</strong>í•´ì£¼ê³  <strong>ì•„ë‹ˆë©´ nullì„ ë°˜í™˜</strong>í•˜ì—¬ í•´ë‹¹ ì¡°ê±´ì„ ë¬´ì‹œí•˜ë„ë¡ ì„¤ì •</li>
          <li><strong>ì¬ì‚¬ìš©ì´ ê°€ëŠ¥</strong>í•˜ë©° <strong>ì¡°í•©</strong> ë˜í•œ ê°€ëŠ¥ â†’ <strong>ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©</strong></li>
          <li>
            <p>ì˜ˆì‹œ) <code class="language-plaintext highlighter-rouge">usernameEq(cond.getUsername())</code></p>

            <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">usernameEq</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nf">hasText</span><span class="o">(</span><span class="n">username</span><span class="o">)</span> <span class="o">?</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">username</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div>            </div>

            <ul>
              <li><strong>MemberSearchCond</strong>ì˜ <strong>uesrnameì´ nullì´ê±°ë‚˜ ë¹ˆë¬¸ìì—´ì´ë©´ nullì„ ë°˜í™˜</strong> í•˜ê³  <strong>ì•„ë‹ˆë¼ë©´ ì¡°ê±´ ì¶”ê°€</strong></li>
            </ul>
          </li>
          <li>
            <p><strong>ì¡°ê±´ ì¡°í•©</strong> ì˜ˆì‹œ</p>

            <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">ageBetween</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">ageGoe</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">ageLoe</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">ageGoe</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="n">ageLoe</span><span class="o">(</span><span class="n">ageLoe</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">ageLoe</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="n">ageGoe</span><span class="o">(</span><span class="n">ageGoe</span><span class="o">);</span>
      <span class="k">return</span> <span class="nf">ageGoe</span><span class="o">(</span><span class="n">ageGoe</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">ageLoe</span><span class="o">(</span><span class="n">ageLoe</span><span class="o">));</span>
  <span class="o">}</span>
</code></pre></div>            </div>

            <ul>
              <li>ì¡°ê±´ë“¤ì„ ì¡°í•©(<code class="language-plaintext highlighter-rouge">.and()</code>, <code class="language-plaintext highlighter-rouge">.or()</code>) í•´ì„œ ë°˜í™˜í•´ì£¼ëŠ” ë°©ì‹</li>
              <li>ì´ë•Œ <code class="language-plaintext highlighter-rouge">~~Predicate</code>ë¡œ ë°˜í™˜~~í•˜ë©´ ë™ì‘í•˜ì§€ ì•ŠìŒ â†’ ì¡°í•©ì„ ìœ„í•´ì„œ <code class="language-plaintext highlighter-rouge">BooleanExpression</code> ì‚¬ìš©</li>
              <li><strong>ì¡°í•©</strong> ì‹œ í•­ìƒ <strong>null ì¡°ê±´ì— ëŒ€í•´ ìœ ì˜</strong>í•´ì•¼ ë¨ â†’ ì¡°í•©ì¤‘ í•˜ë‚˜ë§Œ nullì¼ ê²½ìš°, ë‘˜ë‹¤ nullì¼ ê²½ìš° ë“±</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Respository í™œìš©</strong> (ì¡°íšŒ API ì»¨íŠ¸ë¡¤ëŸ¬ ê°œë°œ)
    <ul>
      <li><code class="language-plaintext highlighter-rouge">MemberController</code> ê°œë°œ</li>
      <li>
        <p>Class ë‹¨ Annotation</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@RestController</span> <span class="c1">// Rest API</span>
  <span class="nd">@RequiredArgsConstructor</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{...}</span>
</code></pre></div>        </div>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">@RestController</code> : <strong>API ë°˜í™˜</strong>ì„ ìœ„í•œ <strong>Controller</strong> ì„¤ì •</li>
          <li><code class="language-plaintext highlighter-rouge">@RequiredArgsConstructor</code> : private final ë¡œ ì„¤ì •ëœ fieldì— ëŒ€í•´ <strong>ìë™ìœ¼ë¡œ DI</strong>ì‹¤í–‰ â†’ ìƒì„±ìë¥¼ í†µí•´</li>
        </ul>
      </li>
      <li>
        <p>ì˜ì¡´ì„± ì£¼ì… (DI)</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberQueryRepository</span> <span class="n">memberQueryRepository</span><span class="o">;</span>
</code></pre></div>        </div>

        <ul>
          <li>MemberQueryRepository ì£¼ì… : Querydslì„ í†µí•´ ê°œë°œí•œ Repository</li>
        </ul>
      </li>
      <li>
        <p>ê²€ìƒ‰ì¡°ê±´ì— ë”°ë¥¸ ë°ì´í„° ë°˜í™˜</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/v1/members"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchMemberV1</span><span class="o">(</span><span class="nd">@ModelAttribute</span> <span class="nc">MemberSearchCond</span> <span class="n">cond</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">memberQueryRepository</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">cond</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>        </div>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">@GetMapping</code>
            <ul>
              <li>/v1/members ì— ì‘ë‹µ</li>
            </ul>
          </li>
          <li><code class="language-plaintext highlighter-rouge">@ModelAttribute MemberSearchCond cond</code>
            <ul>
              <li>RequestParamì„ í†µí•´ ë“¤ì–´ì˜¤ëŠ” ê°’ë“¤ì„ <strong>MemberSearchCondì— Mapping</strong> ì‹œì¼œì¤Œ</li>
              <li>ex) <strong>?username=kim&amp;goe=20</strong> â†’ <code class="language-plaintext highlighter-rouge">MemberSearchCond{username = kim, goe = 20, â€¦}</code></li>
            </ul>
          </li>
          <li><code class="language-plaintext highlighter-rouge">return memberJPARepository.search(cond)</code>
            <ul>
              <li>ë¦¬í¬ì§€í† ë¦¬ë¥¼ í†µí•´ <strong>ìë°”ì½”ë“œë¡œ ì‘ì„±í•œ ë™ì  ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜</strong></li>
              <li>JSONí˜•ì‹ìœ¼ë¡œ ë°˜í™˜ â†’ APIí˜¸ì¶œ ê²°ê³¼ê°’</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="ìŠ¤í”„ë§-ë°ì´í„°-jpaì™€-querydsl">ìŠ¤í”„ë§ ë°ì´í„° JPAì™€ Querydsl</h2>

<p><strong>ìŠ¤í”„ë§ ë°ì´í„° JPA ì™€ Querydslì„ ë™ì‹œì— ì‚¬ìš©</strong>í•˜ê¸°</p>

<h3 id="ìŠ¤í”„ë§-ë°ì´í„°-jpa-ê¸°ë°˜-repository-ìƒì„±">ìŠ¤í”„ë§ ë°ì´í„° JPA ê¸°ë°˜ Repository ìƒì„±</h3>

<ul>
  <li><strong>MemberRepository interface</strong> ìƒì„±
    <ul>
      <li><code class="language-plaintext highlighter-rouge">extends JpaRepository&lt;Member, Long&gt;</code> : <strong>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©</strong>í•˜ê¸° ìœ„í•´ì„œ JpaRepository ìƒì†</li>
      <li><code class="language-plaintext highlighter-rouge">public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { }</code></li>
      <li><strong>ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ê¸°ëŠ¥ ì œê³µ</strong>ë¨
        <ul>
          <li>ì €ì¥(<code class="language-plaintext highlighter-rouge">save()</code>), ì•„ì´ë””ë¥¼ í†µí•œ ì¡°íšŒ(<code class="language-plaintext highlighter-rouge">findById()</code>), ì „ì²´ ì¡°íšŒ(<code class="language-plaintext highlighter-rouge">findAll()</code>), â€¦</li>
        </ul>
      </li>
      <li><strong>ë©”ì„œë“œ ì´ë¦„ì„ í†µí•´ ìë™ ì¿¼ë¦¬ ìƒì„±</strong> ê°€ëŠ¥
        <ul>
          <li>ex) ì´ë¦„ì„ í†µí•œ ì¡°íšŒ(<code class="language-plaintext highlighter-rouge">findByUsername()</code> â†’ <strong>findâ€¦ByField()</strong>)</li>
        </ul>
      </li>
      <li>í•˜ì§€ë§Œ <strong>í•´ë‹¹ Repositoryì—ëŠ” Querydslì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ</strong> â†’ Interface ì´ë¯€ë¡œ Querydslì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ <strong>í•´ë‹¹ Repositoryì˜ ëª¨ë“  ë©”ì„œë“œë¥¼ êµ¬í˜„</strong>í•˜ë©´ì„œ <strong>Querydslí•­ëª©ì„ ì¶”ê°€ êµ¬í˜„</strong>í•´ì£¼ì–´ì•¼ ë¨ â†’ ë¶ˆê°€ëŠ¥ <strong>â‡’ [ì¤‘ìš”] ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼ í†µí•´ Querydslë§Œ ë”°ë¡œ êµ¬í˜„</strong></li>
    </ul>
  </li>
</ul>

<h3 id="ì‚¬ìš©ì-ì •ì˜-ë¦¬í¬ì§€í† ë¦¬-ìƒì„±">ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ ìƒì„±</h3>

<ul>
  <li>
    <p>ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ ì‚¬ìš©ë²•
  <img src="/images/posts/post-220926/Untitled.png" alt="Untitled" /></p>

    <ol>
      <li>ì‚¬ìš©ì ì •ì˜ <strong>ì¸í„°í˜ì´ìŠ¤ ìƒì„±</strong> (MemberRepoCustom interface)</li>
      <li>ì‚¬ìš©ì ì •ì˜ <strong>ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„</strong> (MemberRepositoryImpl class (<strong>êµ¬í˜„ì²´</strong>))</li>
      <li>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ì— ì‚¬ìš©ì ì •ì˜ <strong>ì¸í„°í˜ì´ìŠ¤ ìƒì†</strong> 
  (<code class="language-plaintext highlighter-rouge">... extends JPARepository&lt;,&gt; , MemberRepoCustom</code>)
        <ol>
          <li><strong>ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ìƒì„± â†’ <code class="language-plaintext highlighter-rouge">MemberRepoCustom interface</code></strong></li>
        </ol>
      </li>
    </ol>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepositoryCustom</span> <span class="o">{</span>
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">condition</span><span class="o">);</span>
  <span class="o">}</span>
    
</code></pre></div>    </div>

    <ul>
      <li>QueryDSLê³¼ Spring Data JPAë¥¼ <strong>ê°™ì´ ì‚¬ìš©í•˜ê¸° ìœ„í•œ custom repo ì¸í„°í˜ì´ìŠ¤</strong></li>
      <li><code class="language-plaintext highlighter-rouge">search()</code> : ì´ì „ íŒŒíŠ¸ì—ì„œ ì§„í–‰í–ˆë˜ <strong>ì¡°ê±´ì— ë”°ë¥¸ ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±</strong>ì„ <strong>Querydslì˜ BooleanExpression ìœ¼ë¡œ êµ¬í˜„</strong>í•œ ë©”ì„œë“œ</li>
      <li>ì´ë ‡ê²Œ Interfaceë¡œ ì„ ì–¸í•´ì£¼ê³  <strong>êµ¬í˜„ì²´ì—ì„œ í•´ë‹¹ ë©”ì„œë“œë¥¼ Override í•´ì„œ êµ¬í˜„</strong>í•´ì£¼ë©´ ë¨!
        <ol>
          <li><strong>ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ â†’ <code class="language-plaintext highlighter-rouge">MemberRepositoryImpl class</code> (êµ¬í˜„ì²´)</strong></li>
        </ol>
      </li>
    </ul>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@RequiredArgsConstructor</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRepositoryImpl</span> <span class="kd">implements</span> <span class="nc">MemberRepositoryCustom</span><span class="o">{</span> 
    		
      <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>
    
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">cond</span><span class="o">)</span> <span class="o">{...}</span>
  	  <span class="o">...</span>
  <span class="o">}</span>
</code></pre></div>    </div>

    <ul>
      <li>QueryDSLê³¼ Spring Data JPAë¥¼ <strong>ê°™ì´ ì‚¬ìš©í•˜ê¸° ìœ„í•œ custom repo êµ¬í˜„ì²´</strong></li>
      <li>ì£¼ì˜í•  ì ì€ <strong>êµ¬í˜„ì²´ì˜ ì´ë¦„</strong>ì„ í•­ìƒ <strong>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ëŠ” Interfaceì˜ ì´ë¦„(â€MemberRepositoryâ€) + â€œImplâ€ ë¡œ ì„¤ì •</strong>í•´ì£¼ì–´ì•¼ í•¨ â†’ ì´ë˜ì•¼ì§€ ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ <strong>êµ¬í˜„ì²´ë¥¼ ì¸ì‹í•˜ê³  Custom Interfaceì™€ ì—°ê²°</strong>í•´ì¤Œ!</li>
      <li>QueryDSLì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ <strong>JPAQueryFactoryë¥¼ ì˜ì¡´ì„± ì£¼ì…</strong>í•´ì¤Œ</li>
      <li>custom Interfaceì—ì„œ ì •ì˜í•œ <code class="language-plaintext highlighter-rouge">search()</code> <strong>ë©”ì„œë“œ êµ¬í˜„</strong> â†’ ì´ì „ê³¼ ë™ì¼í•œ method (Whereì ˆì— íŒŒë¼ë¯¸í„°ë¥¼ ì´ìš©í•˜ì—¬ ë™ì  ì¿¼ë¦¬ ì‘ì„±)
        <ol>
          <li><strong>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ì— ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ìƒì† â†’ <code class="language-plaintext highlighter-rouge">extends JPARepository&lt;Member, Long&gt; , MemberRepoCustom)</code></strong></li>
        </ol>
      </li>
    </ul>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;,</span> <span class="nc">MemberRepositoryCustom</span> <span class="o">{</span>
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span> <span class="c1">// ë©”ì„œë“œ ì´ë¦„ì„ í†µí•œ ìë™ ì¿¼ë¦¬ ìƒì„±</span>
  <span class="o">}</span>
</code></pre></div>    </div>

    <ul>
      <li>ì´ë ‡ê²Œ ë˜ë©´ <strong>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ëŠ” MemberRepository ì—ì„œë„ Querydslì„ ì´ìš©í•œ method ì‚¬ìš© ê°€ëŠ¥</strong> â†’ <code class="language-plaintext highlighter-rouge">memberRepository.search(â€¦)</code></li>
    </ul>
  </li>
</ul>

<h3 id="querydsl-í˜ì´ì§•-ì—°ë™">Querydsl í˜ì´ì§• ì—°ë™</h3>

<ul>
  <li><strong>Spring Data ì˜ Page, Pageableì„ ì‚¬ìš©</strong>í•´ì„œ <strong>Querydslë¡œë„ í˜ì´ì§• ê¸°ëŠ¥ì„ êµ¬í˜„</strong>í•´ë³´ê¸°</li>
  <li>
    <p>Queyrdslì„ ìœ„í•œ <strong>Custom Repositoryì— í˜ì´ì§• ê¸°ëŠ¥ì„ í¬í•¨í•œ method ì¶”ê°€</strong></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepositoryCustom</span> <span class="o">{</span>
    
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">condition</span><span class="o">);</span>
    
      <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchPage</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">condition</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>    </div>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">Page&lt;MemberTeamDto&gt; searchPage(MemberSearchCond condition, Pageable pageable);</code>
        <ul>
          <li>pageableì— <strong>page ì¡°ê±´ì„ ë„£ì–´ì£¼ë©´ Pageë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë” ë°˜í™˜</strong></li>
          <li>í•´ë‹¹ methodë¥¼ êµ¬í˜„ì²´ì—ì„œ êµ¬í˜„í•´ì£¼ê¸°ë§Œ í•˜ë©´ ë¨</li>
          <li>ì¦‰, <strong>Pageableì„ ì‚¬ìš©í•œ Querydslì˜ ë™ì  ì¿¼ë¦¬ë¡œ Page ë°˜í™˜ ê°€ëŠ¥</strong> â†’ ê·¸ëŒ€ë¡œ ì›¹ê³„ì¸µì—ì„œ Pageë¥¼ í†µí•´ í˜ì´ì§• ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥!</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">searchPage()</code> method êµ¬í˜„
    <ul>
      <li>
        <p>ì¿¼ë¦¬ ê²°ê³¼(content) ë¶€ë¶„</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="n">content</span> <span class="o">=</span> <span class="n">queryFactory</span>
  	      <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
  	              <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
  	      <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
  	      <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
  	      <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span> <span class="c1">// í•´ë‹¹ ë©”ì„œë“œì—ì„œ nullì„ ë°˜í™˜í•˜ê²Œ ë˜ë©´ ë¬´ì‹œë¨</span>
  	              <span class="n">teamNameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
  	              <span class="n">ageGoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
  	              <span class="n">ageLoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
  	      <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">asc</span><span class="o">())</span>
  	      <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getOffset</span><span class="o">())</span>
  	      <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">())</span>
  	      <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div>        </div>

        <ul>
          <li><strong>Pageable(í˜ì´ì§• ì •ë³´ë¥¼ ë‹´ì€ ê°ì²´)</strong> ì—ì„œ <strong>offset</strong>ê³¼ <strong>page size</strong>ë¥¼ ì–»ì–´ì™€ <code class="language-plaintext highlighter-rouge">.offset()</code> ê³¼ <code class="language-plaintext highlighter-rouge">.limit()</code> ì„¤ì •ì„ í†µí•´ <strong>í˜ì´ì§• êµ¬í˜„</strong>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">.offset(pageable.getOffset())</code></li>
              <li><code class="language-plaintext highlighter-rouge">.limit(pageable.getPageSize())</code></li>
            </ul>
          </li>
          <li><code class="language-plaintext highlighter-rouge">~~.fetchResults()~~</code> ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ë¨ìœ¼ë¡œì¨ <strong>ì§ì ‘ count query ì‘ì„± í•„ìš”</strong></li>
        </ul>
      </li>
      <li>
        <p>ì „ì²´ ê°œìˆ˜ ì¡°íšŒ ë¶€ë¶„</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nc">Long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">count</span><span class="o">())</span> <span class="c1">// count query -&gt; fetchCount ëŒ€ìš©</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span> <span class="c1">// í•´ë‹¹ ë©”ì„œë“œì—ì„œ nullì„ ë°˜í™˜í•˜ê²Œ ë˜ë©´ ë¬´ì‹œë¨</span>
                <span class="n">teamNameEq</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                <span class="n">ageGoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                <span class="n">ageLoe</span><span class="o">(</span><span class="n">cond</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
</code></pre></div>        </div>

        <ul>
          <li>ì„±ëŠ¥ ìµœì í™” ë° <code class="language-plaintext highlighter-rouge">~~.fetchResults()~~</code> ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œë¨ìœ¼ë¡œì¨ <strong>ì§ì ‘ count query</strong> ìƒì„±</li>
          <li><code class="language-plaintext highlighter-rouge">~~.fetchCount()~~</code> ê°€ ì—†ì–´ì§ìœ¼ë¡œì¨ <code class="language-plaintext highlighter-rouge">member.count()</code> ë¥¼ í†µí•´ <strong>ì „ì²´ ê°œìˆ˜ë¥¼ ê°€ì ¸</strong>ì˜´</li>
        </ul>
      </li>
      <li>
        <p>content(ì¿¼ë¦¬ ê²°ê³¼ ë‚´ìš©)ì™€ total(ì „ì²´ ê°œìˆ˜)ë¥¼ í†µí•´ <strong>Page ìƒì„±</strong></p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">return</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;&gt;(</span><span class="n">content</span><span class="o">,</span> <span class="n">pageable</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
</code></pre></div>        </div>

        <ul>
          <li><strong>Page</strong>ë¥¼ í†µí•´ ë°˜í™˜í•˜ì—¬ <strong>ì›¹ ê³„ì¸µì—ì„œ ì§ì ‘ í˜ì´ì§• ê¸°ëŠ¥ì„ ì‚¬ìš©</strong>í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •</li>
          <li><code class="language-plaintext highlighter-rouge">PageImpl&lt;&gt;</code> ì— <strong>ì¿¼ë¦¬ ê²°ê³¼ ë‚´ìš©, í˜ì´ì§• ì •ë³´, ì „ì²´ ê°œìˆ˜</strong>ë¥¼ ë„£ì–´ <strong>Page ê°ì²´ë¥¼ ìƒì„±</strong>í•˜ì—¬ ë°˜í™˜</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Querydsl + Page ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ <strong>ì»¨íŠ¸ë¡¤ëŸ¬</strong> ê°œë°œ</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/v2/members"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchMemberByPage</span><span class="o">(</span><span class="nc">MemberSearchCond</span> <span class="n">cond</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">searchPage</span><span class="o">(</span><span class="n">cond</span><span class="o">,</span> <span class="n">pageable</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>    </div>

    <ul>
      <li>ê¸°ì¡´ì— ìƒì„±í–ˆë˜ <code class="language-plaintext highlighter-rouge">MemberController</code>ì— <code class="language-plaintext highlighter-rouge">searchMemberByPage</code>ì¶”ê°€</li>
      <li><code class="language-plaintext highlighter-rouge">â€œ/v2/membersâ€</code> ì—ì„œì˜ RequestParam ìœ¼ë¡œ ë°›ì•„ì˜¨ <strong>MemberSearchCond(ê²€ìƒ‰ ì¡°ê±´)</strong> ê³¼ <strong>Pageable(í˜ì´ì§• ì •ë³´)</strong>ë¥¼ í†µí•´ searchPage ë™ì‘</li>
      <li>ex) <strong>?uesrname=kim&amp;page=0&amp;size=16</strong> â‡’ usernameì´ â€œkimâ€ì¸ memberë¥¼ ì¡°íšŒí•˜ëŠ”ë° 16ê°œë¡œ ëŠì–´ì§„ í˜ì´ì§€ì—ì„œ ê°€ì¥ ì²«ë²ˆì§¸ í˜ì´ì§€ì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ë¼ â†’ <strong>Pageì •ë³´ë¥¼ ê°€ì§„ JSONìœ¼ë¡œ ë°˜í™˜</strong></li>
      <li>Pageë¡œ ë°˜í™˜ë˜ì—ˆê¸° ë•Œë¬¸ì— <strong>content ë¿ë§Œ ì•„ë‹Œ page ì •ë³´ë“¤ì´ JSONìœ¼ë¡œ ë°˜í™˜</strong>ë¨ â†’ API í˜¸ì¶œì˜ ê²°ê³¼</li>
    </ul>
  </li>
</ul>
:ET